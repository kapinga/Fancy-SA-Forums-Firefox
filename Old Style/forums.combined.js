jQuery.cookie=function(a,b,c){if("undefined"!=typeof b){c=c||{};null===b&&(b="",c.expires=-1);var e="";if(c.expires&&("number"==typeof c.expires||c.expires.toUTCString))"number"==typeof c.expires?(e=new Date,e.setTime(e.getTime()+864E5*c.expires)):e=c.expires,e="; expires="+e.toUTCString();var f=c.path?"; path="+c.path:"",g=c.domain?"; domain="+c.domain:"",c=c.secure?"; secure":"";document.cookie=[a,"=",encodeURIComponent(b),e,f,g,c].join("")}else{b=null;if(document.cookie&&""!=document.cookie){c=
document.cookie.split(";");for(e=0;e<c.length;e++)if(f=jQuery.trim(c[e]),f.substring(0,a.length+1)==a+"="){b=decodeURIComponent(f.substring(a.length+1));break}}return b}};window.SA||(SA={});
SA.utils=new function(a){var b=this;b.storageEnabled=a.localStorage?!0:!1;b.store=function(a){if(b.storageEnabled&&null!==a){var e=null;if(1<arguments.length)e=arguments[1],null===e?localStorage.removeItem(a):localStorage.setItem(a,JSON.stringify(e));else if(e=localStorage.getItem(a),null!==e)return JSON.parse(e)}return null}}(window,document,jQuery);
new function(a,b,c){var e=c.browser.webkit||c.browser.safari?"body":"html",f,g=0,h=0,k=function(a){var c=Math.floor(160*Math.random())+1;return"http://fi.somethingawful.com/sideimages/"+a+"88/"+c+".jpg"},d=function(){f.offset();var a=c(e).scrollTop(),b={position:"absolute",top:g},d=c("div#content"),k=d.offset().top,d=d.height(),k=k+d-h;a>k?d>h&&(b.top=k):a>=g&&(c.browser.msie&&7>parseInt(c.browser.version,10)?b.top=a:(b.position="fixed",b.top=0));f.css(b)};c(b).ready(function(){var b=c("div.oma_pal"),
e=c(new Image);e.attr({width:88,height:88,"class":"omapalpet"});e.css("display","block");b.each(function(a,b){var b=c(b),d=e.clone();d.addClass("left");d.attr("src",k("l"));b.prepend(d);d=e.clone();d.addClass("right");d.attr("src",k("r"));b.append(d)});f=c("div#unregskyscraper");f.length&&(g=f.offset().top-10,h=f.height()+10,c(a).scroll(d));c("iframe.adframe").each(function(a,b){c(b).attr("src","/adframe.php?z="+c(b).attr("data-zone"))})})}(window,document,jQuery);
function newposts(a){window.location.href="/showthread.php?goto=newpost&threadid="+a}function validate_pm(a,b){return""==a.message.value||""==a.touser.value?(alert("Please complete the recipient and message fields."),!1):0!=b&&a.message.value.length>b/2?(alert("Your message is too long.\n\nReduce your message to "+b/2+" characters.\nIt is currently "+a.message.value.length+" characters long."),!1):!0}
function confirm_newpm(){input_box=confirm("You have a new private message. Click OK to view it, or cancel to hide this prompt.");!0==input_box&&(second_box=confirm("Open in new window?\n\n(Press cancel to open in the current window.)"),!0==second_box?window.open("private.php","pmnew"):window.location="private.php")}function posticon_sel(a){document.vbform.iconid.item(a).checked=!0}
function validate(a,b){if(a.elements.namedItem("subject")&&""==a.subject.value)return alert("Please complete the subject field, shithead."),!1;var c=a.elements.namedItem("message");return c&&""==a.message.value?(alert("Please complete the message field, shithead."),!1):0!=b&&c.length>b?(alert("Your message is too long.\n\nReduce your message to "+b+" characters.\nIt is currently "+a.message.value.length+" characters long.\n  Are you trying to spam?\n  If so, then STOP!"),!1):!0}
function checklength(a,b){b||(b=0);message=0!=b?"\nThe maximum permitted length is "+b+" characters.":"";alert("Your message is "+a.message.value.length+" characters long."+message)}function rate_thread(a){document.rateform.vote.value=a;document.rateform.submit()}function reloadCaptcha(){document.images.captcha.src="captcha.php?"+Math.random()}
"undefined"!=typeof dojo&&(dojo.require("dojo.lang.declare"),dojo.declare("flag_rotator",null,{initialized:!1,node:null,timer:null,ticktime:60,forumid:0,initializer:function(a,b){this.node=dojo.byId(b);this.forumid=a;if(this.node&&!(1>this.forumid)){var c;if(0<(c=dojo.io.cookie.get("flag_timer")))this.ticktime=c;1>this.ticktime||(15>this.ticktime&&(this.ticktime=15),dojo.require("dojo.lang.timing.Timer"),this.timer=new dojo.lang.timing.Timer(1E3*this.ticktime),dojo.event.connect(this.timer,"onTick",
dojo.lang.hitch(this,"rotate")),this.img=document.createElement("img"),this.img.style.display="none",this.img.className="flag",this.node.appendChild(this.img),this.initialized=!0)}},go:function(){this.initialized&&(this.timer.start(),this.rotate())},rotate:function(){dojo.io.bind({url:"/flag.php?forumid="+this.forumid,mimetype:"text/javascript",load:dojo.lang.hitch(this,function(a,b){var c=b.flags[0],e="http://fi.somethingawful.com/flags"+c.path+"?by="+encodeURIComponent(c.owner);this.show_image(e,
"This flag proudly brought to you by '"+c.owner+"' on "+c.created)}),error:function(){}})},show_image:function(a,b){this.img.src=a;this.img.title=b;this.img.style.display="block"}}),dojo.addOnLoad(function(){var a=dojo.byId("flag_container");if(!a){a=document.createElement("div");a.id="flag_container";var b=dojo.html.getElementsByClassName("breadcrumbs");if(1>b.length)return;dojo.dom.insertBefore(a,b[0])}"undefined"!=typeof rotate_forumid&&rotate_forumid&&(flagro=new flag_rotator(rotate_forumid,a),
flagro.go())}));
var posticon_clickmaster={forumid:null,setforumid:function(a){this.forumid=a},make_clicky:function(a){a=dojo.byId(a);a=dojo.html.getElementsByClassName("icon",a,"td");for(i=0;i<a.length;i++){var b=dojo.dom.getFirstChildElement(a[i],"img");b.style.cursor="pointer";b.title="click to filter threads by this icon";dojo.event.connect(b,"onclick",this,"handle_click")}},handle_click:function(a){a=a.currentTarget.src.split(/#/)[1];window.location="/forumdisplay.php?forumid="+this.forumid+"&posticon="+a}},
bookmark_button={img:null,bottomlink:null,threadid:0,img_bookmarked:"http://fi.somethingawful.com/images/buttons/button-bookmark.gif",img_notbookmarked:"http://fi.somethingawful.com/images/buttons/button-unbookmark.gif",init:function(a,b){this.img=a;this.bottomlink=dojo.byId("bookmark_link");this.threadid=b;this.img.onclick=dojo.lang.hitch(this,this.handle_click);this.bottomlink.firstChild.onclick=dojo.lang.hitch(this,this.handle_click);this.bottomlink.firstChild.style.cursor=this.img.style.cursor=
"pointer";this.bottomlink.firstChild.style.borderBottom="1px #666 solid";this.bottomlink.firstChild.innerHTML=(dojo.html.hasClass(this.img,"unbookmark")?"Unb":"B")+"ookmark this thread";this.opaque();this.show()},show:function(){this.bottomlink.style.display="block";this.img.style.display="inline"},hide:function(){this.bottomlink.style.display=this.img.style.display="none"},fade:function(){this.bottomlink.style.opacity=this.img.style.opacity="0.4"},opaque:function(){this.bottomlink.style.opacity=
this.img.style.opacity="1.0"},handle_click:function(){this.img.onclick=function(){};this.bottomlink.firstChild.onclick=function(){};this.fade();var a={};a.threadid=this.threadid;a.action=dojo.html.hasClass(this.img,"unbookmark")?"remove":"add";this.bottomlink.firstChild.innerHTML=(dojo.html.hasClass(this.img,"unbookmark")?"Unb":"B")+"ookmark this thread";a.json=1;dojo.io.bind({method:"POST",content:a,url:"/bookmarkthreads.php",load:dojo.lang.hitch(this,function(a,c){this.img.onclick=dojo.lang.hitch(this,
this.handle_click);this.bottomlink.firstChild.onclick=dojo.lang.hitch(this,this.handle_click);this.bottomlink.firstChild.innerHTML=(c.bookmarked?"Unb":"B")+"ookmark this thread";this.img.src=this["img_"+(c.bookmarked?"not":"")+"bookmarked"];this.img.className=c.bookmarked?"unbookmark":"bookmark";this.opaque()}),error:dojo.lang.hitch(this,function(){alert("Failed to alter bookmark");this.opaque()}),mimetype:"text/javascript"})}};
$(document).ready(function(){var a=$("#thread table.post");$(a).each(function(a,b){try{var f=$(b).find("td.userinfo").get(0),g=f.className.match(/\buserid\-(\d+)\b/)[1];$(f).data("userid",g);var h=b.id.match(/\bpost(\d+)\b/)[1];$(b).data({userid:g,postid:h});var k=$(b).find("tr td.postlinks ul.profilelinks"),d=3<=k.find("li").length?2:1;$(k).find("li:eq("+d+")",k).after('\n<li><a href="/banlist.php?userid='+g+'">Rap Sheet</a></li>')}catch(j){}});var b=RegExp(/^\(USER WAS (?:BANNED|PUT ON PROBATION) FOR THIS POST\)$/);
$(a).each(function(a,e){try{$(e).find("td.postbody > b:last").filter(function(a,c){return!!$(c).text().match(b)}).wrapInner('<a href="/banlist.php?userid='+$(e).data("userid")+'" />')}catch(f){}});$("td.postbody .cancerous").closest("td").hover(function(){$(".cancerous",this).addClass("hover")},function(){$(".cancerous",this).removeClass("hover")})});
function add_whoposted_links(){$("#forum.threadlist tr.thread").each(function(a,b){try{var c=b.id.match(/^thread(\d+)$/)[1];$("td.replies",b).wrapInner('<a href="/misc.php?action=whoposted&amp;threadid='+c+'" target="_blank" title="List users that posted in this thread" />')}catch(e){}})}
var bm_stars={icon_url:"http://fi.somethingawful.com/style/bookmarks/",icon_extension:"gif",categories:3,icons:{},do_category_colors:!1,init:function(a){this.do_category_colors=a;for(a=0;a<this.categories;a++)this.icons[a]=new Image,this.icons[a].src=this.icon_url+"star"+a+"."+this.icon_extension;this.icons.off=new Image;this.icons.off.src=this.icon_url+"star-off."+this.icon_extension;this.icons.spin=new Image;this.icons.spin.src=this.icon_url+"spin3."+this.icon_extension},toggle:function(a,b){a.src=
this.icons.spin.src;a.onclick=function(){};var c={};c.threadid=b;c.action="cat_toggle";c.json=1;dojo.io.bind({method:"POST",content:c,url:"/bookmarkthreads.php",load:dojo.lang.hitch(this,function(c,f){a.onclick=dojo.lang.hitch(this,function(){this.toggle(a,b)});this.set_star(a,f.category_id);var g=dojo.html.getParentByType(a,"tr");dojo.html.removeClass(g,"category0");dojo.html.removeClass(g,"category1");dojo.html.removeClass(g,"category2");0<=f.category_id&&(g.className="category"+f.category_id+" "+
g.className)}),error:dojo.lang.hitch(this,function(){a.src=this.icon_url+"warning.gif";a.title="An error occurred while updating the bookmark!"}),mimetype:"text/javascript"})},set_star:function(a,b){a.title="Bookmark category updated!";a.src=0<=b?this.icons[b].src:this.icons.off.src}},seen={anchors:[],get_anchor:function(a){threadid=seen.get_threadid(a);seen.anchors[threadid]?a=seen.anchors[threadid]:seen.anchors[threadid]=a=new seen_anchor(a);return a},get_threadid:function(a){tr=dojo.dom.getFirstAncestorByTag(a,
"tr");return tr.id.substring(6)},reset:function(a){var b=seen.get_anchor(a);if(b.is_busy())return!1;b.set_busy(1);a={};a.threadid=b.threadid;a.action="resetseen";a.json=1;dojo.io.bind({method:"POST",content:a,url:"/showthread.php",load:dojo.lang.hitch(this,function(a,e){e&&e.threadid?b.make_unseen():(alert("Failed to reset status, try again..."),b.set_busy(0))}),error:dojo.lang.hitch(this,function(){alert("Failed to reset status, try again...");b.set_busy(0)}),mimetype:"text/json"})}};dojo.require("dojo.lang.declare");
dojo.declare("seen_anchor",null,{_busy:0,threadid:0,node:null,div_seen:null,initializer:function(a){this.node=a;tr=this.get_parent_tr();this.div_seen=dojo.html.getElementsByClass("lastseen",tr)[0];this.threadid=tr.id.substring(6)},set_busy:function(a){a?(this._busy=1,a="<"):(this._busy=0,a="X");dojo.dom.replaceChildren(this.node,document.createTextNode(a))},is_busy:function(){return this._busy?1:0},get_parent_tr:function(){return dojo.dom.getFirstAncestorByTag(this.node,"tr")},make_unseen:function(){tr=
this.get_parent_tr();dojo.html.removeClass(tr,"seen");dojo.html.getElementsByClass("lastseen",tr)[0].style.display="none";this.set_busy(0)}});
dojo.declare("bookmarks_button_remove",null,{domNode:null,button:null,initializer:function(){var a=this.domNode=document.createElement("td");a.className="button_remove";this.button=document.createElement("div");this.button.title="Click to delete this bookmark";a.appendChild(this.button);this.enable()},enable:function(){dojo.event.connect(this.button,"onclick",dojo.lang.hitch(this,"handle_click"))},disable:function(){dojo.event.connect(this.button,"onclick",function(){})},handle_click:function(a){this.disable();
dojo.html.addClass(this.button,"spin");dojo.html.removeClass(this.button,"warn");var b=seen.get_threadid(a.currentTarget),a={};a.threadid=b;a.action="remove";a.json=1;dojo.io.bind({method:"POST",content:a,url:"/bookmarkthreads.php",load:dojo.lang.hitch(this,function(){dojo.html.removeClass(this.button,"spin");dojo.byId("thread"+b).style.display="none"}),error:dojo.lang.hitch(this,function(){dojo.html.removeClass(this.button,"spin");dojo.html.addClass(this.button,"warn");this.button.title="An error occurred while removing the bookmark!  Try again...";
this.enable()}),mimetype:"text/javascript"})}});
var bookmarks_mui={add_buttons:function(){var a=dojo.html.getElementsByClass("threadlist")[0],b=dojo.dom.getFirstChildElement(dojo.dom.getFirstChildElement(a,"thead"),"tr"),c=document.createElement("th");c.appendChild(document.createTextNode(""));b.appendChild(c);a=dojo.html.getElementsByClass("thread",dojo.dom.getFirstChildElement(a,"tbody"),"tr");for(b=0;b<a.length;b++)c=new bookmarks_button_remove(a[b].id),a[b].appendChild(c.domNode)},add_buttons_button:function(){var a=dojo.byId("bookmark_edit_attach");
void 0!=a&&(a.className="enabled",a.innerHTML="Edit Bookmarks",a.title="Click the red icon next to a bookmark to permanently remove it from the list",dojo.event.connect(a,"onclick",dojo.lang.hitch(this,function(){a.style.display="none";this.add_buttons()})))}},ratebar={img_url_base:"http://fi.somethingawful.com/style/thread/rate/",rateform:void 0,node:void 0,select_vote:void 0,threadid:void 0,digg_url:void 0,init:function(){if(this.rateform=dojo.byId("rateform")){this.node=dojo.byId("rateform_js_attach");
this.rateform.style.display="none";dojo.lang.forEach(this.rateform.elements,function(a){"vote"==a.name&&(select_vote=a);"threadid"==a.name&&(threadid=a.value);"digg_url"==a.name&&(digg_url=a.value)});this.select_vote=select_vote;this.threadid=threadid;this.digg_url=digg_url;for(i=1;5>=i;i++){var a=this.make_ratebutton(i);this.node.appendChild(a)}a=this.make_diggbutton();this.node.appendChild(a)}},make_ratebutton:function(a){var b=document.createElement("img");b.src=this.img_url_base+"rate"+a+".gif";
dojo.event.connect(b,"onclick",dojo.lang.hitch(this,function(){this.vote(a)}));return b},make_diggbutton:function(){var a=document.createElement("img");a.src=this.img_url_base+"digg.gif";a.title="Vote this thread five and digg it!";dojo.event.connect(a,"onclick",dojo.lang.hitch(this,function(){this.vote_digg()}));return a},vote_digg:function(){this.vote(5);window.open(this.digg_url,"digg")},vote:function(a){this.select_vote.value=a;this.display_spin();dojo.io.bind({url:"/threadrate.php",load:dojo.lang.hitch(this,
function(b,c){this.vote_success(a,c)}),error:dojo.lang.hitch(this,function(a,c){this.vote_fail(c)}),mimetype:"text/json-comment-filtered",method:"post",headers:{"X-Ajax-Engine":"Dojo/"+dojo.version},content:{threadid:this.threadid,vote:a}})},vote_success:function(a,b){b.error?this.display_error(b.error):this.display_ok(a)},vote_fail:function(a){this.display_error(a.error||a.msg)},display_spin:function(){var a=document.createElement("b");a.innerHTML='<img src="http://fi.somethingawful.com/style/thread/rate/spin.gif"> Something is happening...';
dojo.dom.replaceChildren(this.node,a)},display_error:function(a){var b=document.createElement("b");b.innerHTML='<img src="http://fi.somethingawful.com/images/warning.gif"> Vote failed: '+a;dojo.dom.replaceChildren(this.node,b)},display_ok:function(a){var b=document.createElement("b");b.innerHTML="You rated this thread '"+a+"'! Great job, go hog wild!";dojo.dom.replaceChildren(this.node,b)}};dojo.addOnLoad(ratebar,"init");
new function(a,b,c){var e="_sessl",e=e+"",f=function(a){return parseInt(a,10)+0},g=function(a){for(var a=a.substr(1).split("&"),c=0,b,j={},e=a.length,f;c<e;c++)b=a[c].indexOf("="),-1!=b&&(f=a[c].substr(0,b),b=a[c].substr(b+1),j[f]=b);return j};c(b).ready(function(){if(c("div#notregistered").length){c("table#forum th a").each(function(a,b){c(b).replaceWith(b.childNodes)});c("ul.postbuttons img#button_bookmark").parent().remove();var b=a.location.search;if(b){var k=g(b),d=b=0,j=0;if(k.hasOwnProperty("forumid"))b=
f(k.forumid);else{var m=c('div.breadcrumbs a[href^="forumdisplay.php"]').last();m.length&&(m=m.attr("href"),m=g(m.substr(m.indexOf("?"))),m.hasOwnProperty("forumid")&&(b=f(m.forumid)))}k.hasOwnProperty("threadid")&&(d=f(k.threadid));k.hasOwnProperty("postid")&&(j=f(k.postid));var k=!0,m=f((new Date).getTime()/1E3),l=c.cookie(e);if(l&&(value=l.split("."),4==value.length)){var l=f(value[0]),u=f(value[1]),x=f(value[2]),n=f(value[3]);180>m-n&&(k=!1,l==b&&u==d&&x==j||(k=!0))}k&&(b=[b,d,j,m].join("."),
c.cookie(e,b,{expires:10,domain:"forums.somethingawful.com"}),c("body").append('<img src="/s/'+b+'" alt="">'))}}})}(window,document,jQuery);window.SA||(SA={});
SA.timg=new function(a,b,c){var e=this,f=function(b,e){var d=c(this).siblings("img"),j,f;if(d.attr("t_width"))c(this).removeClass("expanded"),d.attr({width:d.attr("t_width"),height:d.attr("t_height")}),d.removeAttr("t_width"),d.removeAttr("t_height");else{c(this).addClass("expanded");d.attr({t_width:d.attr("width"),t_height:d.attr("height")});var l=d.parents("blockquote");l.length||(l=d.parents(".postbody"));j=parseInt(d.attr("o_width"),10);f=parseInt(d.attr("o_height"),10);l=Math.min(900,l.width());
if(e&&j>l){var g=d.position(),l=(l-3*g.left)/j;d.attr("width",j*l);d.attr("height",f*l)}else d.removeAttr("width"),d.removeAttr("height");l=c.browser.webkit||c.browser.safari?"body":"html";f=c(l).scrollTop();j=d.offset().top;d=j+d.height();d-f>c(a).height()&&(f=d-c(a).height());j<f&&(f=j);f!=c(l).scrollTop()&&(c.browser.msie&&7>parseInt(c.browser.version,10)?c(l).scrollTop(f):c(l).animate({scrollTop:f},150))}return!1},g=function(){var a=c(this);if(a.hasClass("loading")){a.removeClass("loading");var b=
a[0].naturalWidth||a.width(),d=a[0].naturalHeight||a.height();if(200>d&&500>=b||170>b)a.removeClass("timg");else{a.addClass("complete");a.attr({o_width:b,o_height:d});var b=b+"x"+d,d=1,e=a[0].naturalWidth||a.width(),g=a[0].naturalHeight||a.height();170<e&&(d=170/e);200<g*d&&(d=200/g);a.attr({width:e*d,height:g*d});var d=c('<span class="timg_container"></span>'),l=c('<div class="note"></div>');l.text(b);l.attr("title","Click to toggle");d.append(l);a.before(d);d.prepend(a);l.click(f);d.click(function(a){if(1===
a.which||c.browser.msie&&9>parseInt(c.browser.version,10)&&0===a.which)return f.call(l,a,!0),!1})}a.trigger("timg.loaded")}};e.scan=function(a){c(a).find("img.timg").each(function(a,b){b=c(b);b.hasClass("complete")||(b.addClass("loading"),b[0].complete||null!==b[0].naturalWidth&&0<b[0].naturalWidth?g.call(b):b.load(g))})};c(b).ready(function(){e.scan("body")});c(a).load(function(){var a=c("img.timg.loading");a.length&&a.each(function(a,c){g.call(c)})})}(window,document,jQuery);
(function(a,b,c){var e=!1,f=[],g={},h=null,k=null,d=[],j=0,m=0,l=0,u=0,x="",n=null,p=null,y=!1,B=a.localStorage?!0:!1,O=a.JSON&&JSON.stringify&&JSON.parse,s=!1,z=!1,G=!1,C=!1,D=0,E=function(a){if(B&&null!==a){var c=null,a="postreply_"+a;if(1<arguments.length)c=arguments[1],null===c?localStorage.removeItem(a):localStorage.setItem(a,JSON.stringify(c));else if(c=localStorage.getItem(a),null!==c)return JSON.parse(c)}return null},H=function(a){var c="\n";"\n"!=h[0].value.substr(h[0].value.length-1)&&(c+=
"\n");t(c+a,null,!1)},F=function(){if(!e&&f.length){e=!0;var a=c(f.shift());g[a.attr("href")]?(H(g[a.attr("href")]),F()):c.get(a.attr("href")+"&json=1",{},function(c){g[a.attr("href")]=c.body;H(c.body);a.children("img").attr("src","http://fi.somethingawful.com/images/sa-quote-added.gif");F()},"json")}else e=!1},P=function(){c(this).css("opacity",0.6);f.push(this);F();return!1},I=function(){if(B&&(null===d||1<d.length)){var a=new Date,b=null;if(s)b="forum-"+u;else if(z)b="reply-"+l;else return;n.find("div.save-state").text("Saved: "+
a.toLocaleDateString()+" "+a.toLocaleTimeString());E(b,{time:a.getTime(),message:c.trim(h[0].value)})}},A=function(){clearInterval(m);if(null!==d){j!=d.length-1&&d.splice(j+1,d.length-j-1);var a=r();d.push({selection:a,scroll:h[0].scrollTop,text:h[0].value});j=d.length-1}I()},J=function(){if(d.length&&0<=j&&j<d.length){var a=d[j].selection;h[0].value=d[j].text;v(a.start,a.end);h[0].scrollTop=d[j].scroll;q();I()}},K=function(){j=Math.min(d.length-1,j+1);J()},w=function(){clearInterval(m);m=setTimeout(A,
250)},r=function(){var a=null;"new"==y&&(a={start:h[0].selectionStart,end:h[0].selectionEnd});return a},v=function(a){h[0].setSelectionRange(a,2==arguments.length?arguments[1]:a)},L=function(a){for(var c=[[0,47],[58,64],[91,96],[123,126]],b=0,d=c.length,e=!1;b<d;b++)if(a>=c[b][0]&&a<=c[b][1]){e=!0;break}return e},M=function(a){var c=r(),b=h[0].value,d=b.lastIndexOf("["+a,c.start);return-1!=d?(d=b.indexOf("[/"+a+"]",d),-1==d?!1:d+3>c.end):!1},t=function(a,c,b){null===c&&(c=r());var d=h[0].scrollTop,
e=h[0].value,f=e.substring(0,c.start),j=e.substring(c.start,c.end),e=e.substr(c.end),g=c.start;b?(b="["+a+"]"+j+"[/"+a+"]",h[0].value=f+b,g=c.start==c.end?c.start+a.length+2:c.start+b.length):(h[0].value=f+a,g=c.start+a.length);c.end=g;h[0].scrollTop=h[0].scrollHeight;h[0].value+=e;h[0].scrollTop<d&&(h[0].scrollTop=d);v(g);A();q();return c},N=function(a){var a=a.split("&"),c={},b,d;for(d in a)b=a[d].indexOf("="),-1!=b?c[a[d].substr(0,b)]=a[d].substr(b+1):c[a[d]]=!0;return c},Q=function(){var a=r(),
c=null;return 5<=a.start&&(c=h[0].value.substr(a.start-5),/^(\[img\]|\[url\]|\[url="?)/.test(c))||6<=a.start&&(c=h[0].value.substr(a.start-6),/^\[timg\]/.test(c))?!0:!1},R=function(a){var c=null,b="";if(a.originalEvent.metaKey||a.originalEvent.ctrlKey){var d=null;switch(a.keyCode){case 66:d="b";break;case 73:d="i";break;case 76:var d=r(),e=h[0].value,f=e.substring(0,d.start),b=e.substring(d.start,d.end),g="[list]\n[*]"+b+"\n[/list]",e=e.substr(d.end);h[0].value=f+g+e;v(d.start+b.length+10);A();q();
a.stopPropagation();a.preventDefault();return!1;case 81:d="quote";break;case 83:d="s";break;case 85:d="u";break;case 86:if(Q())break;c=r();k.val("");k.focus();setTimeout(function(){var a=c,b=k[0].value;if(/^https?:\/\//.test(b)&&-1==b.indexOf("\n")&&-1==b.indexOf("\r")){var d;var e=/([^:]+):\/\/([^\/]+)(\/.*)?/.exec(decodeURI(b));if(e){var f={scheme:e[1],domain:e[2],path:e[3],filename:"",query:{},fragment:""},e=f.path.lastIndexOf("#");-1!=e&&(f.fragment=f.path.substr(e+1),f.path=f.path.substr(0,e));
e=f.path.lastIndexOf("?");-1!=e&&(f.query=N(f.path.substr(e+1)),f.path=f.path.substr(0,e));e=f.path.lastIndexOf("/");-1!=e&&(f.filename=f.path.substr(e+1));d=f}else d=null;var f=e="",g=!1,j=d.filename.lastIndexOf(".");-1!=j&&(e=d.filename.substr(j+1),f=d.filename.substr(0,j));/^([^\.]+\.)?youtube(-nocookie)?\.com$/.test(d.domain)&&(d.query.v?(b='[video type="youtube"',d.query.hd&&(b+=' res="hd"'),d.fragment&&(g=N(d.fragment),g.t&&(b+=' start="'+parseInt(g.t,10)+'"')),b+="]"+d.query.v+"[/video]",g=
!0):/^\/embed/.test(d.path)&&(b='[video type="youtube"',d.query.hd&&(b+=' res="hd"'),d.query.start&&(b+=' start="'+parseInt(d.query.start,10)+'"'),b+="]"+d.path.substr(d.path.lastIndexOf("/")+1)+"[/video]",g=!0));if(!g)switch(e){case "jpg":case "gif":case "png":if(/(www\.|i\.)imgur.com/i.test(d.domain))switch(d="",5<f.length&&(d=f.substr(f.length-1)),d){case "s":case "l":case "t":b="[url="+(b.substr(0,b.lastIndexOf("/")+1)+f.substr(0,f.length-1)+"."+e)+"][img]"+b+"[/img][/url]";break;default:b="[img]"+
b+"[/img]"}else b="[img]"+b+"[/img]"}}h.focus();t(b,a,!1)},50);break;case 88:return w(),!0;case 89:return K(),a.preventDefault(),a.stopPropagation(),!1;case 90:return a.shiftKey?K():(j=Math.max(0,j-1),J()),a.preventDefault(),a.stopPropagation(),!1}if(null!==d&&(c=r(),null!==c)){if(!a.shiftKey&&c.start==c.end){b=h[0].value;f=c.start;g=f-1;e=b.length;for(f={start:f,end:f};0<=g;){if(L(b.charCodeAt(g))){g++;break}g--}for(f.start=g;g<e&&!L(b.charCodeAt(g));)g++;f.end=g;c=f}a.preventDefault();a.stopPropagation();
t(d,c,!0);return!1}}else{d=null;switch(a.keyCode){case 13:!a.shiftKey&&M("list")&&(d="\n[*]");break;case 9:M("code")&&(d="\t")}if(null!==d)return t(d,null,!1),a.preventDefault(),a.stopPropagation(),!1;w()}return!0},q=function(){var a=n.find("div.character-count"),b=h[0].value.length;D=b;if(0<b&&5E4>=b&&a.hasClass("over"))a.removeClass("over"),c('input.bginput[type="submit"]').attr("disabled",!1);else if(5E4<b||0===b)a.addClass("over"),c('input.bginput[type="submit"]').attr("disabled",!0);C?b=Math.round(1E5*
Math.random())-5E4:3E4<b&&!a.is(":visible")&&a.show();a.text(b+" / 50000")};c(b).ready(function(){s=!!c('form[action="newthread.php"]').length;z=!!c('form[action="newreply.php"]').length;G=!!c('form[action="editpost.php"]').length;C=!!c("body.forum_26").length;if(s||z||G){h=c('textarea[name="message"]');n=c('<div class="post-wrapper"></div>');h.before(n);n.append('<div class="postinfo"><div class="save-state">New reply</div><div class="character-count">0 / 50000</div></div>');n.prepend(h);h.css("width",
"auto");h.keyup(q);h.change(function(){w();q()});setInterval(function(){D!=h[0].value.length&&(w(),q())},1E3);C&&n.find("div.character-count").show();void 0!==h[0].selectionStart&&void 0!==h[0].selectionEnd?y="new":b.selection&&(y="ie legacy");O&&!s&&(c(b).delegate('td.postlinks > ul.postbuttons > li > a[href^="newreply.php"]',"click",P),p=c("div#content > div.standard"),p.length||(p=c('<div class="standard"><h2>Post Preview:</h2><div class="inner postbody"></div></div>'),p.css("width","100%"),p.hide(),
c("div#content > div.breadcrumbs").after(p)));if(B){l=c('input[name="threadid"]').val();u=c('input[name="forumid"]').val();x=h[0].value;var e=null;s?e=E("forum-"+u):z&&(e=E("reply-"+l));if(null!==e&&e.message!=x){var f=n.find("div.save-state"),g=new Date(e.time);f.html("<strong>Draft from: "+g.toLocaleDateString()+" "+g.toLocaleTimeString()+"</strong>");g=c('<a href="#">[Append]</a>');g.click(function(){t(e.message,null,!1);return!1});f.append(g);g=c('<a href="#">[Replace]</a>');g.click(function(){h[0].value=
"";t(e.message,null,!1);v(e.length);return!1});f.append(g);s||(g=c('<a href="#">[Preview]</a>'),g.click(function(){var a=e.message,b={action:c('input[name="action"]').val(),threadid:c('input[name="threadid"]').val(),formkey:c('input[name="formkey"]').val(),form_cookie:c('input[name="form_cookie"]').val(),preview:"Preview Reply",message:a};c('form[action="newreply.php"] input[type="checkbox"]:checked').each(function(a,d){d=c(d);b[d.attr("name")]="yes"});c.post("newreply.php?json=1",b,function(a){var b=
p.find("div.postbody");b.empty();b.html(a.preview);p.show();SA.timg.scan(b);k.css({top:h.offset().top});a=c.browser.webkit||c.browser.safari?"body":"html";b=p.offset();b.top<c(a).scrollTop()&&c(a).animate({scrollTop:b.top},150)});return!1}),f.append(g))}}else n.find("div.save-state").text("Drafts not enabled in your browser");"new"==y&&(a.adv_post_disabled?(d=null,h.keyup(function(){D!=h[0].value.length&&(w(),q())})):(k=c("<textarea></textarea>"),k.css({position:"absolute",left:-2E3,top:h.offset().top}),
c("body").append(k),h.keydown(R),v(h[0].value.length),A()));q();h.focus()}})})(window,document,jQuery);window.SA||(SA={});
SA.thread=new function(a,b,c){var e=/\?postid=(\d+)/,f=/#post(\d+)/,g=c.browser.webkit||c.browser.safari?"body":"html",h=function(b){var e=c("#"+b);if(e.length||"top"==b){if(c.browser.msie&&9>parseInt(c.browser.version,10))a.location.href="#"+b;else{var f=e.length?e.offset().top:0;e.attr("id","");a.location.href="#"+b;e.attr("id",b);c(g).animate({scrollTop:f},150)}return!1}return!0},k=function(){var a=c(this).attr("href"),b=null;if(/^https?:\/\//.test(a)&&!/^https?:\/\/(.*\.)?forums\.somethingawful\./.test(a)||
/^\/?attachment\.php/.test(a))return!0;e.test(a)?b=e:f.test(a)&&(b=f);return null!==b?(a="post"+b.exec(a)[1],h(a)):!0};c(b).ready(function(){var d=c('<div class="jump_top left">UP</div>'),e=c('<div class="jump_top right">UP</div>');c(b).delegate("td.postbody a","click",k);c.browser.msie&&7>parseInt(c.browser.version,10)?(e.show(),c("body").append(e)):(c("body").append(d),c("body").append(e),c(b).mousemove(function(b){var f=d.is(":visible"),h=e.is(":visible"),k=b.pageY>c(g).scrollTop()+c(a).height()-
100;k&&100>b.pageX?(h&&e.hide(),f||d.show()):(k&&b.pageX>c(a).width()-100?h||e.show():h&&e.hide(),f&&d.hide())}));c("div.jump_top").click(function(){return h("top")});c('form.forum_jump select[name="forumid"]').change(function(){var b=c(this),d=b.val(),b=b.siblings('input[name="daysprune"]').val();if(-1==d)return!1;a.location.href="/forumdisplay.php?daysprune="+b+"&forumid="+d})})}(window,document,jQuery);
